<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.3">
<meta name="author" content="Ken Kousen">
<title>Creating Build Scans</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
<link rel="stylesheet" href="https://guides.gradle.org/asciidoctor.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700|Source+Code+Pro:500">
<link rel="apple-touch-icon" sizes="180x180" href="https://guides.gradle.org/icon/apple-touch-icon.png">
<link rel="icon" type="image/png" href="https://guides.gradle.org/icon/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://guides.gradle.org/icon/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="https://guides.gradle.org/icon/manifest.json">
<link rel="mask-icon" href="https://guides.gradle.org/icon/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="https://guides.gradle.org/icon/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Basic Build Scans">
<meta name="application-name" content="Basic Build Scans">
<meta name="msapplication-config" content="https://guides.gradle.org/icon/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<script defer src="https://guides.gradle.org/js/set-time-to-complete-text.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,"script","https://www.google-analytics.com/analytics.js","ga");
  ga("create", "UA-4207603-1", "auto");
  ga("send", "pageview");
</script>
</head>
<body class="article toc2 toc-right">
<div id="header"><div style="padding-top: 10px;"><a href="https://guides.gradle.org"><img src="http://guides.gradle.org/gradle-guides.svg" alt=""></a></div><h1>Creating Build Scans</h1>
<div class="details">
<span id="author" class="author">Ken Kousen</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what_you_ll_create">What you&#8217;ll create</a></li>
<li><a href="#what_you_ll_need">What you&#8217;ll need</a></li>
<li><a href="#select_a_sample_project">Select a sample project</a></li>
<li><a href="#apply_the_build_scan_plugin">Apply the build-scan plugin</a></li>
<li><a href="#add_the_license_agreement">Add the license agreement</a></li>
<li><a href="#run_the_build_scan">Run the build scan</a></li>
<li><a href="#access_the_scan_online">Access the scan online</a></li>
<li><a href="#enable_build_scans_for_all_builds_optional">Enable build scans for all builds (optional)</a></li>
<li><a href="#summary">Summary</a></li>
<li><a href="#next_steps">Next Steps</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A build scan is a shareable and centralized record of a build that provides insights into what happened and why. By applying the build scan plugin to your project, you can create a build scan in the Gradle Cloud for free.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what_you_ll_create"><a class="anchor" href="#what_you_ll_create"></a>What you&#8217;ll create</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide shows you how to modify a build script to enable build scans. Optionally, you will also modify an <code>init</code> script to enable build scans for all of your applications.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what_you_ll_need"><a class="anchor" href="#what_you_ll_need"></a>What you&#8217;ll need</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Either your own sample project, or you can use the sample available from Gradle</p>
</li>
<li>
<p>Access to the Internet</p>
</li>
<li>
<p>Access to your email</p>
</li>
<li>
<p>About <span class="time-to-complete-text"></span></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="select_a_sample_project"><a class="anchor" href="#select_a_sample_project"></a>Select a sample project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Gradle makes available a simple Java project that you can use to demonstrate build scan capabilities. If you wish to use it, clone or download the repository located at <a href="https://github.com/gradle/gradle-build-scan-quickstart" class="bare">https://github.com/gradle/gradle-build-scan-quickstart</a> . If you prefer to use your own build, you can skip this step.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="apply_the_build_scan_plugin"><a class="anchor" href="#apply_the_build_scan_plugin"></a>Apply the build-scan plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add a <code>plugins</code> block to the <code>build.gradle</code> file with the following contents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
    id <span class="string"><span class="delimiter">'</span><span class="content">com.gradle.build-scan</span><span class="delimiter">'</span></span> version <span class="string"><span class="delimiter">'</span><span class="content">1.6</span><span class="delimiter">'</span></span> <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Use latest version of plugin which can be found from the <a href="https://plugins.gradle.org/plugin/com.gradle.build-scan">Gradle Plugin Portal</a>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you already have a <code>plugins</code> block, always put the build-scan plugin first. Adding it below any existing plugins will still work, but will miss useful information.</p>
</div>
<div class="paragraph">
<p>Using the <code>plugins</code> block in this way will not only download the plugin, it will apply it as well.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="add_the_license_agreement"><a class="anchor" href="#add_the_license_agreement"></a>Add the license agreement</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to use the build-scan plugin, you need to agree to the terms of service. This is an automated process that you can enable by adding the following section to your build file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">buildScan {
    licenseAgreementUrl = <span class="string"><span class="delimiter">'</span><span class="content">https://gradle.com/terms-of-service</span><span class="delimiter">'</span></span>
    licenseAgree = <span class="string"><span class="delimiter">'</span><span class="content">yes</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>buildScan</code> block allows you to configure the plugin. Here you are setting two properties necessary to agree to the terms of service. Other properties are available. See the <a href="https://docs.gradle.com/scans/">Build Scans User Manual</a> for details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="run_the_build_scan"><a class="anchor" href="#run_the_build_scan"></a>Run the build scan</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The scan is enabled using a command-line flag called <code>--scan</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>--scan</code> option replaces the older, deprecated <code>-Dscan</code> syntax, which you will still find in some documentation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Run a <code>build</code> task with the <code>--scan</code> option. When the build is completed, after uploading data to the Gradle servers, you will be presented with a link to follow to retrieve your report.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gradlew build --scan
// ... tasks related to the build ...
:build

BUILD SUCCESSFUL

Total time: x.yz secs

Publishing build information...
https://gradle.com/s/7msdnpptouxg4</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="access_the_scan_online"><a class="anchor" href="#access_the_scan_online"></a>Access the scan online</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first time you follow the link, you will be asked to provide your email address so that a separate link can be sent to you. You will also have an opportunity to check a box to allow Gradle to remember you, so you won&#8217;t have to go through the email process in the future.</p>
</div>
<div class="paragraph">
<p>The resulting email will look similar to:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/build_scan_email.png" alt="build scan email">
</div>
</div>
<div class="paragraph">
<p>Follow the link provided in the email, and you will see the resulting scan.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/build_scan_page.png" alt="build scan page">
</div>
</div>
<div class="paragraph">
<p>You can now explore all the information contained in the build scan, including the time taken for tasks to execute, the time required during each stage of the build, the results of any tests, plugins used and other dependencies, any command-line switches used, and more.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="enable_build_scans_for_all_builds_optional"><a class="anchor" href="#enable_build_scans_for_all_builds_optional"></a>Enable build scans for all builds (optional)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can avoid having to add the plugin and license agreement to every build by using a Gradle init script. Create a file called <code>buildScan.gradle</code> in the directory <code>~/.gradle/init.d</code> (where the tilde represents your home directory) with the following contents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">initscript {
    repositories {
        maven { url <span class="string"><span class="delimiter">'</span><span class="content">https://plugins.gradle.org/m2</span><span class="delimiter">'</span></span> }
    }

    dependencies {
        classpath <span class="string"><span class="delimiter">'</span><span class="content">com.gradle:build-scan-plugin:1.6</span><span class="delimiter">'</span></span>
    }
}

rootProject {
    apply <span class="key">plugin</span>: com.gradle.scan.plugin.BuildScanPlugin

    buildScan {
        licenseAgreementUrl = <span class="string"><span class="delimiter">'</span><span class="content">https://gradle.com/terms-of-service</span><span class="delimiter">'</span></span>
        licenseAgree = <span class="string"><span class="delimiter">'</span><span class="content">yes</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The init script downloads the build-script plugin if necessary and applies it to every project, and approves the license agreement. Now you can use the <code>--scan</code> flag on any build on your system.</p>
</div>
<div class="paragraph">
<p>There are additional capabilities you can add to the script, such as under what conditions to publish the scan information. For details, see the Build Scans User Manual.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="summary"><a class="anchor" href="#summary"></a>Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this guide, you learned how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the build-scan plugin to your build</p>
</li>
<li>
<p>Add a <code>buildScan</code> block to agree to the terms of service</p>
</li>
<li>
<p>Generate a build scan</p>
</li>
<li>
<p>View the build scan information online</p>
</li>
<li>
<p>Create an init script to enable scans for all builds</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="next_steps"><a class="anchor" href="#next_steps"></a>Next Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Additional information can be found in the <a href="https://docs.gradle.com/scans/">Build Scans User Manual</a>.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-06-09 11:06:14 UTC
</div>
</div>
</body>
</html>